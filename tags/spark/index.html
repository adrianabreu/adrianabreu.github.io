<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="es-ES">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Spark | Adrián Abreu</title>

<meta property='og:title' content='Spark - Adrián Abreu'>
<meta property='og:description' content=''>
<meta property='og:url' content='https://adrianabreu.gitlab.io/tags/spark/'>
<meta property='og:site_name' content='Adrián Abreu'>
<meta property='og:type' content='website'><meta property='og:image' content='https://www.gravatar.com/avatar/a77b883f262f485b0135c6e352fc6b87?s=256'><meta property='article:section' content='Tags'><meta property='og:updated_time' content='2024-03-22T18:06:32Z'/><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@adrianabreudev'><meta name='twitter:creator' content='@adrianabreudev'>

<link rel="stylesheet" href="/css/style.css"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://adrianabreu.gitlab.io/tags/spark/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta property="og:image" content="/preview.png" />
<meta name="twitter:image" content="/preview.png" />
<script
    defer
    src="https://unpkg.com/@tinybirdco/flock.js"
    data-token="p.eyJ1IjogImUzY2IxNjA4LThmYjEtNDBjNC04NzNlLTFmNjE3ZmI2NGMzMCIsICJpZCI6ICI1NzQ5MDAyMC02Yjg1LTQ2YjEtYWVmOS1lNzMwMjYwYmM1YmQiLCAiaG9zdCI6ICJldV9zaGFyZWQifQ.bcYOUv9CsZ5Fg6UoqxSZk-SYZ6Z_mdrzjbEiE4TPcAA">
</script>
</head>
<body>
<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://adrianabreu.gitlab.io/">
          <h1 id="nav-heading" class="title is-4">Adrián Abreu</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="github" href='https:/github.com/adrianabreu'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/adrianabreudev'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:adrianabreugonzalez@outlook.com'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/AdrianAbreu'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>
<section class="section">
  <div class="container">
    
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/scala/">#Scala</a>
  
  | <a class="subtitle is-6" href="/tags/wsl/">#WSL</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">March 22, 2024</h2>
      <h1 class="title"><a href="https://adrianabreu.gitlab.io/blog/2024-03-22-developing-on-windows/">Developing on windows</a></h1>
      <div class="content">
        Over the years, I&rsquo;ve been using MacOS at work and Ubuntu at home for my development tasks. However, my Lenovo P1 Gen 3 laptop didn&rsquo;t work well with Linux, leading to frequent issues with the camera and graphics (screen flickering, I&rsquo;m looking at you, and it hurts).
I&rsquo;ve triend Windows Subsystem for Linux (WSL) but it was quite bad to be honest. But as I&rsquo;ve heard of WSL2 and WSLg, I decided to give it another shot.
        
        <a class="button is-link" href="https://adrianabreu.gitlab.io/blog/2024-03-22-developing-on-windows/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>
  
  | <a class="subtitle is-6" href="/tags/python/">#Python</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">January 26, 2024</h2>
      <h1 class="title"><a href="https://adrianabreu.gitlab.io/blog/2024-01-26-querying-the-databricks-api/">Querying the databricks api</a></h1>
      <div class="content">
        Exploring databricks SQL usage
At my company, we adopted databricks SQL for most of our users. Some users have developed applications that use the JDBC connector, some users have built their dashboards, and some users write plain ad-hoc queries.
We wanted to know what they queried, so we tried to use Unity Catalog&rsquo;s insights, but it wasn&rsquo;t enough for our case. We work with IOT and we are interested in what filters they apply within our tables.
        
        <a class="button is-link" href="https://adrianabreu.gitlab.io/blog/2024-01-26-querying-the-databricks-api/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>
  
  | <a class="subtitle is-6" href="/tags/structured-streaming/">#Structured Streaming</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">October 27, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.gitlab.io/blog/2023-10-27-tweaking-spark-kafka/">Tweaking Spark Kafka</a></h1>
      <div class="content">
        Well, I&rsquo;m facing a huge interesting case. I&rsquo;m working at Wallbox where we need to deal with billions of rows every day. Now we need to use Spark for some Kafka filtering and publish the results into different topics according to some rules.
I won&rsquo;t dig deep into the logic except for performance-related stuff, let&rsquo;s try to increase the processing speed.
When reading from Kafka you usually get 1 task per partition, so if you have 6 partitions and 48 cores you are not using 87.
        
        <a class="button is-link" href="https://adrianabreu.gitlab.io/blog/2023-10-27-tweaking-spark-kafka/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/data-engineer/">#Data Engineer</a>
  
  | <a class="subtitle is-6" href="/tags/delta/">#Delta</a>
  
  | <a class="subtitle is-6" href="/tags/sql/">#SQL</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">March 20, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.gitlab.io/blog/2023-03-20-delta-duplicates/">Duplicates with delta, how can it be?</a></h1>
      <div class="content">
        Long time without writing! On highlights: I left my job at Schwarz It in December last year, and now I&rsquo;m a full-time employee at Wallbox! I&rsquo;m really happy with my new job, and I&rsquo;ve experienced interesting stuff. This one was just one of these strange cases where you start doubting the compiler.
Context One of my main tables represents sensor measures from our chargers with millisecond precision. The numbers are quite high, we are talking over 2 billion rows per day.
        
        <a class="button is-link" href="https://adrianabreu.gitlab.io/blog/2023-03-20-delta-duplicates/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>
  
  | <a class="subtitle is-6" href="/tags/data-engineer/">#Data Engineer</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">August 15, 2022</h2>
      <h1 class="title"><a href="https://adrianabreu.gitlab.io/blog/2024-12-12-15-optimizing-spark-i/">Optimizing Spark</a></h1>
      <div class="content">
        Últimamente me he centrado en mejorar mis habilidades con Spark y he aprovechado para hacer algunos trainings de databricks. (Que por cierto ha sacado Beacons, un programa de reconocimiento para sus colaboradores y ha mencionado algunos nombres muy grandes por ahí).
Y en estos cursos está optimizing spark, que simplifica y explica de una forma bastante sencilla los problemas de rendimientos que ocurren en el mundo de big data. A estos problemas se les denomina las 5s:
        
        <a class="button is-link" href="https://adrianabreu.gitlab.io/blog/2024-12-12-15-optimizing-spark-i/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>
  
  | <a class="subtitle is-6" href="/tags/data-engineer/">#Data Engineer</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">August 15, 2022</h2>
      <h1 class="title"><a href="https://adrianabreu.gitlab.io/blog/2024-12-12-16-optimizing-spark-ii/">Optimizing Spark II</a></h1>
      <div class="content">
        Continuando con la lista de optimizaciones en spark tneemos el spill.
Hacer spill no es más que persistir un rdd en disco, ya que, sus datos no caben en memoria.
Existen varias causas, la más sencilla de pensar es hacer un explode un array donde nuestras columnas crecen de forma exponencial.
Cuando el spill ocurre se puede identificar por dos valores que siempre van de la mano:
Spill (Memory) Spill (Disk) (Estas columnas solo aparecen en la spark ui si hay spill).
        
        <a class="button is-link" href="https://adrianabreu.gitlab.io/blog/2024-12-12-16-optimizing-spark-ii/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>
  
  | <a class="subtitle is-6" href="/tags/photon/">#Photon</a>
  
  | <a class="subtitle is-6" href="/tags/data-engineer/">#Data Engineer</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">August 12, 2022</h2>
      <h1 class="title"><a href="https://adrianabreu.gitlab.io/blog/2022-08-12-testing-photon-engine/">Testing Databricks Photon</a></h1>
      <div class="content">
        I was a bit skeptical about photon since I realized that it cost about double the amount of DBU, required specifically optimized machines and did not support UDFs (it was my main target).
From the Databricks Official Docs:
Limitations Does not support Spark Structured Streaming. Does not support UDFs. Does not support RDD APIs. Not expected to improve short-running queries (&lt;2 seconds), for example, queries against small amounts of data. Photon runtime
        
        <a class="button is-link" href="https://adrianabreu.gitlab.io/blog/2022-08-12-testing-photon-engine/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/databricks/">#DataBricks</a>
  
  | <a class="subtitle is-6" href="/tags/data-engineer/">#Data Engineer</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">July 30, 2022</h2>
      <h1 class="title"><a href="https://adrianabreu.gitlab.io/blog/2022-07-30-databricks-cluster-management/">Databricks Cluster Management</a></h1>
      <div class="content">
        For the last few months, I&rsquo;ve been into ETL optimization. Most of the changes were as dramatic as moving tables from ORC to delta revamping the partition strategy to some as simple as upgrading the runtime version to 10.4 so the ETL starts using low-shuffle merge.
But at my job, we have a lot of jobs. Each ETL can be easily launched at *30 with different parameters so I wanted to dig into the most effective strategy for it.
        
        <a class="button is-link" href="https://adrianabreu.gitlab.io/blog/2022-07-30-databricks-cluster-management/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
  </div>
</section>
<section class="section">
  <div class="container">
    <nav class="level is-mobile">
      <div class="level-left">
        <div class="level-item">
          
        </div>
      </div>
      <div class="level-right is-marginless">
        <div class="level-item">
          
          <a class="button" href="/tags/spark/page/2/">
            Older
            <span class="icon is-small is-marginless">
              <svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <polyline points="14 6 20 12 14 18"/>
    
  </svg>
            </span>
          </a>
          
        </div>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container has-text-centered">
    <p>2017-2022 Adrián Abreu powered by Hugo and Kiss Theme</p>
    
  </div>
</section>



</body>
</html>

