<!DOCTYPE html>
<html xmlns="https://www.w3.org/1999/xhtml"  lang="es-ES">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Spark | Adrián Abreu</title>

<meta property='og:title' content='Spark - Adrián Abreu'>
<meta property='og:description' content=''>
<meta property='og:url' content='https://adrianabreu.com/tags/spark/'>
<meta property='og:site_name' content='Adrián Abreu'>
<meta property='og:type' content='website'><meta property='og:image' content='https://www.gravatar.com/avatar/a77b883f262f485b0135c6e352fc6b87?s=256'><meta property='article:section' content='Tags'><meta property='og:updated_time' content='2024-08-13T07:00:32Z'/><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@adrianabreudev'><meta name='twitter:creator' content='@adrianabreudev'>

<link rel="stylesheet" href="/css/style.css"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://adrianabreu.com/tags/spark/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta property="og:image" content="/preview.png" />
<meta name="twitter:image" content="/preview.png" />
<script
    defer
    src="https://unpkg.com/@tinybirdco/flock.js"
    data-token="p.eyJ1IjogImUzY2IxNjA4LThmYjEtNDBjNC04NzNlLTFmNjE3ZmI2NGMzMCIsICJpZCI6ICI1NzQ5MDAyMC02Yjg1LTQ2YjEtYWVmOS1lNzMwMjYwYmM1YmQiLCAiaG9zdCI6ICJldV9zaGFyZWQifQ.bcYOUv9CsZ5Fg6UoqxSZk-SYZ6Z_mdrzjbEiE4TPcAA">
</script>
</head>
<body>
<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://adrianabreu.com/">
          <h1 id="nav-heading" class="title is-4">Adrián Abreu</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="github" href='https://github.com/adrianabreu'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/adrianabreudev'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:adrianabreugonzalez@outlook.com'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/AdrianAbreu'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>
<section class="section">
  <div class="container">
    
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/analytics/">#Analytics</a>



  
  | <a class="subtitle is-6" href="/tags/spark/">#Spark</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">November 11, 2021</h2>
      <h1 class="title"><a href="https://adrianabreu.com/blog/2021-11-11-multiplying-rows-in-spark/">Multiplying rows in Spark</a></h1>
      <div class="content">
        Earlier this week I checked on a Pull Request that bothered me since I saw it from the first time. Let&rsquo;s say we work for a bank and we are going to give cash to our clients if they get some people to join our bank.
And we have an advertising campaign definition like this:
campaign_id inviter_cash receiver_cash FakeBank001 50 30 FakeBank002 40 20 FakeBank003 30 20 And then our BI teams defines the schema they want for their dashboards.

        
        <a class="button is-link" href="https://adrianabreu.com/blog/2021-11-11-multiplying-rows-in-spark/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/regex/">#Regex</a>



  
  | <a class="subtitle is-6" href="/tags/spark/">#Spark</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">November 5, 2021</h2>
      <h1 class="title"><a href="https://adrianabreu.com/blog/2021-11-01-regex-101/">Regex 101</a></h1>
      <div class="content">
        -You will spent your whole life relearning regex, there is a beginning, but never and end.
Last year I participated in some small code problems and practised some regex. I got used to it and feel quite good at it.
And today I had to use it again. I had the following dataframe:
product attributes 1 (SIZE-36) 2 (COLOR-RED) 3 (SIZE-38, COLOR-BLUE) 4 (COLOR-GREEN, SIZE-39) A wonderful set of string merged with properties that could vary. And we wanted one column for each:

        
        <a class="button is-link" href="https://adrianabreu.com/blog/2021-11-01-regex-101/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/analytics/">#Analytics</a>
  
  | <a class="subtitle is-6" href="/tags/firebase/">#Firebase</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">May 6, 2021</h2>
      <h1 class="title"><a href="https://adrianabreu.com/blog/2021-05-06-exporting-firebase-data/">Exportando los datos de firebase</a></h1>
      <div class="content">
        Si trabajamos analizando los datos de una aplicación móvil es muy probable que esté integrado algún sistema para trackear los eventos de la app. Y entre ellos, uno de los más conocidos es Firebase.
Estos eventos contienen mucha información útil y nos permiten por ejemplo saber, un usuario que se ha ido cuanto tiempo ha usado la aplicación o cuantos dias han pasado.
O si realmente ha seguido el flujo de acciones que esperabamos (con un diagrama de sankey podríamos ver donde se han ido los usuarios).

        
        <a class="button is-link" href="https://adrianabreu.com/blog/2021-05-06-exporting-firebase-data/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/analytics/">#Analytics</a>
  
  | <a class="subtitle is-6" href="/tags/sql/">#SQL</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">September 2, 2020</h2>
      <h1 class="title"><a href="https://adrianabreu.com/blog/2020-09-02-calcular-el-domingo-correspondiente/">Calcular el domingo de la semana</a></h1>
      <div class="content">
        A la hora de publicar reportes es común agrupar los datos por semanas. Otro motivo es alinearse con el negocio donde los cierres pueden producirse en días concretos, por ejemplo, un domingo.
En esos casos si tenemos los datos particionados por días nos interesa saber a que domingo correspondería cada uno de los datos.
Los que venimos de otros entornos tendemos a pensar en esas complicadas librerías de fechas (moment.js, jodatime, etc). Incluso alguien podría pensar en extraer los datos del dataframe y procesarlo en local.

        
        <a class="button is-link" href="https://adrianabreu.com/blog/2020-09-02-calcular-el-domingo-correspondiente/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/analytics/">#Analytics</a>
  
  | <a class="subtitle is-6" href="/tags/datalake/">#Datalake</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">August 25, 2020</h2>
      <h1 class="title"><a href="https://adrianabreu.com/blog/2020-08-25-detectando-ficheros-pequenos/">Detectando ficheros pequenos Spark</a></h1>
      <div class="content">
        Uno de los mayores problemas de rendimiento que podemos encontrar en los datalake es tener que mover una enorme cantidad de ficheros pequeños, por el overhead que eso representa en las transacciones. Este post de databricks recomendada https://forums.databricks.com/questions/101/what-is-an-optimal-size-for-file-partitions-using.html que se crearan ficheros de 1GB parquet.
Sin embargo mucha gente no sabe como detectar esto. Hace poco estuve jugando con un notebook y usando simplemente las herramientas del dbutils pude clasificar los ficheros que tenia en las entidades del datalake en múltiples categorías, así podría estimar cuantos ficheros había en un rango de tiempo.

        
        <a class="button is-link" href="https://adrianabreu.com/blog/2020-08-25-detectando-ficheros-pequenos/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/analytics/">#Analytics</a>
  
  | <a class="subtitle is-6" href="/tags/sql/">#SQL</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">August 11, 2020</h2>
      <h1 class="title"><a href="https://adrianabreu.com/blog/2020-08-11-spark-windows-functions/">Spark windows functions (I)</a></h1>
      <div class="content">
        En analítica, es muy común hacer uso de las funciones de ventana para distintos cálculos. Hace poco me encontré con un pequeño problema cuya solución mejoró muchísimo al usar las funciones de ventana, demos un poco de contexto.
Tenemos una dimensión de usuarios donde los usuarios se van registrando con una fecha y tenemos una tabla de ventas donde tenemos las ventas globales para cada día
Y lo que queremos dar es una visión de cómo cada día evoluciona el programa, para ello se quiere que cada día estén tanto las ventas acumuladas como los registros acumulados.

        
        <a class="button is-link" href="https://adrianabreu.com/blog/2020-08-11-spark-windows-functions/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>




        
      </div>
      <h2 class="subtitle is-6 date">November 9, 2019</h2>
      <h1 class="title"><a href="https://adrianabreu.com/blog/2019-11-09-spark-concepts-basicos/">Conceptos básicos de Spark</a></h1>
      <div class="content">
        Nota del autor: Todos los contenidos de este artículo son extractos del libro &ldquo;The Data Engineer&rsquo;s Guide to Apache Spark&rdquo; que puedes descargar desde la pagina de databricks: https://databricks.com/lp/ebook/data-engineer-spark-guide
Preludio: Cluster: Un cluster no es más que un conjunto de máquinas trabajando de forma coordinada. Un cluster de Spark se compone de nodos. Uno actúa como DRIVER y es el punto de entrada para el código del usuario. Los otros actúan como EXECUTOR que seran los encargados de realizar las operaciones.

        
        <a class="button is-link" href="https://adrianabreu.com/blog/2019-11-09-spark-concepts-basicos/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/docker/">#Docker</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">November 9, 2019</h2>
      <h1 class="title"><a href="https://adrianabreu.com/blog/2019-11-10-empezando-en-spark-con-docker/">Empezando en Spark con Docker</a></h1>
      <div class="content">
        A pesar de haber leído guías tan buenas como:
https://medium.com/@bogdan.cojocar/how-to-run-scala-and-spark-in-the-jupyter-notebook-328a80090b3b
https://medium.com/@singhpraveen2010/install-apache-spark-and-configure-with-jupyter-notebook-in-10-minutes-ae120ebca597
Se me ha hecho cuesta arriba el poder conectar un notebook de jupyter y utilizar Scala. Entre configurar el apache toree para poder usar scala en los notebooks y algún error luego en spark al usarlo desde IntelliJ, me he acabado rindiendo.
Nota del autor: Como disclaimer esto ocurre probablemente porque estoy en Manjaro y mi version de Scala es incompatible. Esta clase de problemas en su día las solucionaba fijando una versión, sin embargo, creo que teniendo una herramienta tan potente como es Docker estoy reinventando la rueda par un problema ya resuelto. Además de que voy a probarlo también en un windows para ver que es una solución agnóstical SO.

        
        <a class="button is-link" href="https://adrianabreu.com/blog/2019-11-10-empezando-en-spark-con-docker/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
  </div>
</section>
<section class="section">
  <div class="container">
    <nav class="level is-mobile">
      <div class="level-left">
        <div class="level-item">
          
          <a class="button" href="/tags/spark/page/2/">
            <span class="icon is-small is-marginless">
              <svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <polyline points="15 18 9 12 15 6"/>
    
  </svg>
            </span>
            Newer
          </a>
          
        </div>
      </div>
      <div class="level-right is-marginless">
        <div class="level-item">
          
          <a class="button" href="/tags/spark/page/4/">
            Older
            <span class="icon is-small is-marginless">
              <svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <polyline points="14 6 20 12 14 18"/>
    
  </svg>
            </span>
          </a>
          
        </div>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container has-text-centered">
    <p>2017-2024 Adrián Abreu powered by Hugo and Kiss Theme</p>
    
  </div>
</section>
</body>
</html>

