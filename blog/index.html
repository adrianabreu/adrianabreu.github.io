<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="es-ES">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Blogs | Adri치n Abreu</title>

<meta property='og:title' content='Blogs - Adri치n Abreu'>
<meta property='og:description' content=''>
<meta property='og:url' content='https://adrianabreu.github.com/blog/'>
<meta property='og:site_name' content='Adri치n Abreu'>
<meta property='og:type' content='website'><meta property='og:image' content='https://www.gravatar.com/avatar/a77b883f262f485b0135c6e352fc6b87?s=256'><meta property='article:section' content='Blog'><meta property='og:updated_time' content='2024-01-26T09:06:32Z'/><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@adrianabreudev'><meta name='twitter:creator' content='@adrianabreudev'>

<link rel="stylesheet" href="/css/style.css"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://adrianabreu.github.com/blog/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta property="og:image" content="/preview.png" />
<meta name="twitter:image" content="/preview.png" />
<script
    defer
    src="https://unpkg.com/@tinybirdco/flock.js"
    data-token="p.eyJ1IjogImUzY2IxNjA4LThmYjEtNDBjNC04NzNlLTFmNjE3ZmI2NGMzMCIsICJpZCI6ICI1NzQ5MDAyMC02Yjg1LTQ2YjEtYWVmOS1lNzMwMjYwYmM1YmQiLCAiaG9zdCI6ICJldV9zaGFyZWQifQ.bcYOUv9CsZ5Fg6UoqxSZk-SYZ6Z_mdrzjbEiE4TPcAA">
</script>
</head>
<body>
<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://adrianabreu.github.com/">
          <h1 id="nav-heading" class="title is-4">Adri치n Abreu</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="gitlab" href='https://gitlab.com/adrianabreu'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 0 1-.3-.94l1.22-3.78 2.44-7.51A.42.42 0 0 1 4.82 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.49h8.1l2.44-7.51A.42.42 0 0 1 18.6 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.51L23 13.45a.84.84 0 0 1-.35.94z"></path>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/adrianabreudev'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:adrianabreugonzalez@outlook.com'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/AdrianAbreu'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>
<section class="section">
  <div class="container">
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>
  
  | <a class="subtitle is-6" href="/tags/python/">#Python</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">January 26, 2024</h2>
      <h1 class="title"><a href="https://adrianabreu.github.com/blog/2024-01-26-querying-the-databricks-api/">Querying the databricks api</a></h1>
      <div class="content">
        Exploring databricks SQL usage
At my company, we adopted databricks SQL for most of our users. Some users have developed applications that use the JDBC connector, some users have built their dashboards, and some users write plain ad-hoc queries.
We wanted to know what they queried, so we tried to use Unity Catalog&rsquo;s insights, but it wasn&rsquo;t enough for our case. We work with IOT and we are interested in what filters they apply within our tables.
        
        <a class="button is-link" href="https://adrianabreu.github.com/blog/2024-01-26-querying-the-databricks-api/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>
  
  | <a class="subtitle is-6" href="/tags/structured-streaming/">#Structured Streaming</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">October 27, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.github.com/blog/2023-10-27-tweaking-spark-kafka/">Tweaking Spark Kafka</a></h1>
      <div class="content">
        Well, I&rsquo;m facing a huge interesting case. I&rsquo;m working at Wallbox where we need to deal with billions of rows every day. Now we need to use Spark for some Kafka filtering and publish the results into different topics according to some rules.
I won&rsquo;t dig deep into the logic except for performance-related stuff, let&rsquo;s try to increase the processing speed.
When reading from Kafka you usually get 1 task per partition, so if you have 6 partitions and 48 cores you are not using 87.
        
        <a class="button is-link" href="https://adrianabreu.github.com/blog/2023-10-27-tweaking-spark-kafka/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/confluent/">#Confluent</a>



  
  | <a class="subtitle is-6" href="/tags/kafka/">#Kafka</a>
  
  | <a class="subtitle is-6" href="/tags/ksql/">#Ksql</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">October 21, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.github.com/blog/2023-10-22-ksql-a-horror-tale/">KSQL, a horror tale</a></h1>
      <div class="content">
        I&rsquo;ve been working in the past weeks on a ksql solution that would filter billions of events and decide where they should land in one topic or another. Sadly, it didn&rsquo;t meet my expectations. I thought it was a much more robust product that would fit our scenario. We were doing a similar filter in Spark, where we were paying traffic costs for both Confluent and AWS. So with kSQL at least we wouldn&rsquo;t pay for our AWS traffic.
        
        <a class="button is-link" href="https://adrianabreu.github.com/blog/2023-10-22-ksql-a-horror-tale/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/confluent/">#Confluent</a>



  
  | <a class="subtitle is-6" href="/tags/avro/">#Avro</a>
  
  | <a class="subtitle is-6" href="/tags/scala/">#Scala</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">October 4, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.github.com/blog/2024-11-04-wire-format-scala/">Implementing Confluent Wire Format In Scala</a></h1>
      <div class="content">
        I&rsquo;ve been working with Confluent for the last few months. I&rsquo;ve been mainly configuring the Terraform project and querying the API for some kSQL setup and tuning. When we had ready our sandbox environment, I wanted to test the throughput.
If you follow the docs is straightforward, you need to use the serializer from the Confluent library. In fact if you use Spark you can use some nice wrapper as ABRiS.
        
        <a class="button is-link" href="https://adrianabreu.github.com/blog/2024-11-04-wire-format-scala/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>



  
  | <a class="subtitle is-6" href="/tags/delta/">#Delta</a>
  
  | <a class="subtitle is-6" href="/tags/unity-catalog/">#Unity Catalog</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">October 2, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.github.com/blog/2023-10-02-repairing-metadata-unity-catalog/">Repairing metadata unity catalog</a></h1>
      <div class="content">
        I&rsquo;ve been subscribed to https://www.dataengineeringweekly.com/p/data-engineering-weekly-148 for years. This last number included several on-call posts on Medium. I found these quite useful.
Today, I got an alert from Metaplane that a cost monitor dashboard was out of date. I checked the processes, and everything was fine. I ran a query to check the freshness of the data and it was ok too.
Metaplane checks our delta table freshness by querying the table information available in the Unity Catalog.
        
        <a class="button is-link" href="https://adrianabreu.github.com/blog/2023-10-02-repairing-metadata-unity-catalog/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>



  
  | <a class="subtitle is-6" href="/tags/workflows/">#Workflows</a>
  
  | <a class="subtitle is-6" href="/tags/airflow/">#Airflow</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">July 28, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.github.com/blog/2023-07-28-extra_params_databricksrunnow/">Adding extra params on DatabricksRunNowOperator</a></h1>
      <div class="content">
        With the new Databricks jobs API 2.1 you have different parameters depending on the kind of tasks you have in your workflow. Like: jar_params, sql_params, python_params, notebook_params&hellip;
And not always the airflow operator is ready to handle all of the. If we check the current release of the DatabricksRunNowOperator, we can see that there is only support for: notebook_params python_params python_named_parameters jar_params spark_submit_params And not the query_params mentioned earlier. But there is a way of combining both, there is a param called jsob that allows you to write the payload of a databricksrunnow and it will also merge the content of the JSON with your named_params!
        
        <a class="button is-link" href="https://adrianabreu.github.com/blog/2023-07-28-extra_params_databricksrunnow/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/databricks/">#Databricks</a>



  
  | <a class="subtitle is-6" href="/tags/terraform/">#Terraform</a>
  
  | <a class="subtitle is-6" href="/tags/unity-catalog/">#Unity Catalog</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">May 23, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.github.com/blog/2023-05-23-enabling-unity-catalog/">Enabling Unity Catalog</a></h1>
      <div class="content">
        I&rsquo;ve spent the last few weeks setting up the unity catalog for my company. It&rsquo;s been an extremely tiring process. And there are several concepts to bring here. My main point is to have a clear view of the requirements.
Disclaimer: as of today with https://github.com/databricks/terraform-provider-databricks release 1.17.0, some steps should be done in an &ldquo;awkward way&rdquo; that is, the account API does not expose the catalog&rsquo;s endpoint and should be done through a workspace.
        
        <a class="button is-link" href="https://adrianabreu.github.com/blog/2023-05-23-enabling-unity-catalog/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
    <article>
      <div class="subtitle tags is-6 is-pulled-right">
        
        
<a class="subtitle is-6" href="/tags/spark/">#Spark</a>



  
  | <a class="subtitle is-6" href="/tags/data-engineer/">#Data Engineer</a>
  
  | <a class="subtitle is-6" href="/tags/delta/">#Delta</a>
  
  | <a class="subtitle is-6" href="/tags/sql/">#SQL</a>
  


        
      </div>
      <h2 class="subtitle is-6 date">March 20, 2023</h2>
      <h1 class="title"><a href="https://adrianabreu.github.com/blog/2023-03-20-delta-duplicates/">Duplicates with delta, how can it be?</a></h1>
      <div class="content">
        Long time without writing! On highlights: I left my job at Schwarz It in December last year, and now I&rsquo;m a full-time employee at Wallbox! I&rsquo;m really happy with my new job, and I&rsquo;ve experienced interesting stuff. This one was just one of these strange cases where you start doubting the compiler.
Context One of my main tables represents sensor measures from our chargers with millisecond precision. The numbers are quite high, we are talking over 2 billion rows per day.
        
        <a class="button is-link" href="https://adrianabreu.github.com/blog/2023-03-20-delta-duplicates/" style="height:28px">
          Read more
        </a>
        
      </div>
    </article>
    
  </div>
</section>
<section class="section">
  <div class="container">
    <nav class="level is-mobile">
      <div class="level-left">
        <div class="level-item">
          
        </div>
      </div>
      <div class="level-right is-marginless">
        <div class="level-item">
          
          <a class="button" href="/blog/page/2/">
            Older
            <span class="icon is-small is-marginless">
              <svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <polyline points="14 6 20 12 14 18"/>
    
  </svg>
            </span>
          </a>
          
        </div>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container has-text-centered">
    <p>2017-2022 Adri치n Abreu powered by Hugo and Kiss Theme</p>
    
  </div>
</section>



</body>
</html>

